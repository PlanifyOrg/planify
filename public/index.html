<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Planify - Modern Event Planning</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <div id="app">
    
    <!-- ============================================
         AUTH VIEW - Login/Register
         ============================================ -->
    <div id="authView">
      <div class="auth-container">
        <!-- Login Card -->
        <div id="loginCard" class="auth-card">
          <div class="auth-header">
            <h2>Welcome to Planify</h2>
            <p>Sign in to continue planning</p>
          </div>
          <div class="auth-body">
            <form id="loginForm" onsubmit="return false;">
              <div class="form-group">
                <label>Username</label>
                <input type="text" name="username" placeholder="Enter your username" required>
              </div>
              <div class="form-group">
                <label>Password</label>
                <input type="password" name="password" placeholder="Enter your password" required>
              </div>
              <button type="submit" class="btn btn-lg" style="width: 100%;">Sign In</button>
            </form>
            <div class="auth-toggle">
              <p>Don't have an account? <a href="register.html"><strong>Create one here</strong></a></p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ============================================
         MAIN VIEW - App Content
         ============================================ -->
    <div id="mainView">
      <!-- Header -->
      <header>
        <div class="container">
          <h1>Planify</h1>
          <div class="header-actions">
            <div class="user-info">
              <div class="user-avatar" id="userAvatar">U</div>
              <span id="currentUsername">User</span>
            </div>
            <button id="logoutBtn" class="btn-sm">Logout</button>
          </div>
        </div>
      </header>

      <!-- Navigation Tabs -->
      <nav class="nav-tabs">
        <div class="container">
          <button data-tab="events">Events</button>
          <button data-tab="meetings">Meetings</button>
          <button data-tab="tasks">Tasks</button>
          <button data-tab="organization">Organization</button>
          <button data-tab="notifications" style="position: relative;">
            Notifications
            <span id="notificationBadge" style="display: none; position: absolute; top: 8px; right: 8px; background: #ff4757; color: white; border-radius: 10px; padding: 2px 6px; font-size: 0.75rem; font-weight: 600; min-width: 18px; text-align: center;"></span>
          </button>
        </div>
      </nav>

      <!-- Content Sections -->
      <main class="container">
        
        <!-- Events Section -->
        <section id="eventsSection" class="content-section active">
          <div class="section-header">
            <h2>My Events</h2>
            <button id="createEventBtn" class="btn">+ Create Event</button>
          </div>
          <div id="eventsList" class="card-grid">
            <!-- Events will be loaded here -->
          </div>
          <div id="eventsEmpty" class="empty-state" style="display: none;">
            <div class="empty-state-icon">üìÖ</div>
            <h3>No Events Yet</h3>
            <p>Create your first event to get started</p>
            <button id="createEventBtnEmpty" class="btn">+ Create Event</button>
          </div>
        </section>

        <!-- Meetings Section -->
        <section id="meetingsSection" class="content-section">
          <div class="section-header">
            <h2>My Meetings</h2>
            <button id="createMeetingBtn" class="btn">+ Plan Meeting</button>
          </div>
          <div id="meetingsList" class="list-group">
            <!-- Meetings will be loaded here -->
          </div>
          <div id="meetingsEmpty" class="empty-state" style="display: none;">
            <div class="empty-state-icon">üë•</div>
            <h3>No Meetings Scheduled</h3>
            <p>Plan your first meeting to collaborate</p>
            <button id="createMeetingBtnEmpty" class="btn">+ Plan Meeting</button>
          </div>
        </section>

        <!-- Tasks Section -->
        <section id="tasksSection" class="content-section">
          <div class="section-header">
            <h2>My Tasks</h2>
            <button id="createTaskBtn" class="btn">+ Create Task</button>
          </div>
          <div id="tasksList" class="list-group">
            <!-- Tasks will be loaded here -->
          </div>
          <div id="tasksEmpty" class="empty-state" style="display: none;">
            <div class="empty-state-icon">‚úì</div>
            <h3>No Tasks Yet</h3>
            <p>Create your first task to track your work</p>
            <button id="createTaskBtnEmpty" class="btn">+ Create Task</button>
          </div>
        </section>

        <!-- Notifications Section -->
        <section id="notificationsSection" class="content-section">
          <div class="section-header">
            <h2>Notifications</h2>
          </div>
          <div id="notificationsList" class="list-group">
            <!-- Notifications will be loaded here -->
          </div>
          <div id="notificationsEmpty" class="empty-state" style="display: none;">
            <div class="empty-state-icon">üîî</div>
            <h3>No Notifications</h3>
            <p>You're all caught up!</p>
          </div>
        </section>

        <!-- Organization Section -->
        <section id="organizationSection" class="content-section">
          <div class="section-header">
            <h2>My Organization</h2>
            <button id="createOrganizationBtn" class="btn">+ Create Organization</button>
          </div>
          <div id="organizationContent">
            <!-- Organization details will be loaded here -->
          </div>
          <div id="organizationEmpty" class="empty-state" style="display: none;">
            <div class="empty-state-icon">üè¢</div>
            <h3>No Organization</h3>
            <p>Create or join an organization to collaborate with your team</p>
            <button id="createOrganizationBtnEmpty" class="btn">+ Create Organization</button>
          </div>
        </section>

      </main>
    </div>

    <!-- ============================================
         MODALS
         ============================================ -->
    
    <!-- Event Modal -->
    <div id="eventModal" class="modal modal-large">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Create Event</h2>
          <button class="close-modal" onclick="closeEventModal()">√ó</button>
        </div>
        <div class="modal-body">
          <form id="eventForm">
            <div class="form-section">
              <h3>üéØ Basic Information</h3>
              <div class="form-group">
                <label>Event Title</label>
                <input type="text" name="title" placeholder="Enter event name" required>
              </div>
              <div class="form-group">
                <label>Description</label>
                <textarea name="description" placeholder="Describe your event" rows="3" required></textarea>
              </div>
              <div class="form-inline">
                <div class="form-group" style="flex: 1;">
                  <label>Start Date & Time</label>
                  <input type="datetime-local" name="startDate" required>
                </div>
                <div class="form-group" style="flex: 1;">
                  <label>End Date & Time</label>
                  <input type="datetime-local" name="endDate" required>
                </div>
              </div>
              <div class="form-group">
                <label>Location</label>
                <input type="text" name="location" placeholder="Event location" required>
              </div>
            </div>

            <div class="form-section">
              <h3>üë• Participants</h3>
              <div class="form-group">
                <label>Search Members</label>
                <input type="text" id="eventParticipantSearch" placeholder="Type to search by username or ID...">
              </div>
              <div id="eventParticipantSearchResults" style="display: none; margin-top: 1rem; max-height: 200px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: var(--radius-md); padding: 0.5rem; background: var(--gray-50);">
                <div id="eventParticipantResultsList"></div>
              </div>
              <div id="eventParticipantsList" style="display: flex; flex-direction: column; gap: 0.5rem; margin-top: 1rem;">
                <!-- Participants will be added here -->
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" onclick="closeEventModal()">Cancel</button>
          <button class="btn" onclick="submitEventForm()">Create Event</button>
        </div>
      </div>
    </div>

    <!-- Meeting Modal -->
    <div id="meetingModal" class="modal modal-large">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Plan Meeting</h2>
          <button class="close-modal" onclick="closeMeetingModal()">√ó</button>
        </div>
        <div class="modal-body">
          <form id="meetingForm">
            <div class="form-section">
              <h3>üìã Basic Information</h3>
              <div class="form-group">
                <label>Meeting Title</label>
                <input type="text" name="title" placeholder="Enter meeting title" required>
              </div>
              <div class="form-group">
                <label>Description</label>
                <textarea name="description" placeholder="Meeting description" rows="2"></textarea>
              </div>
              <div class="form-group">
                <label>Event (Optional)</label>
                <select name="eventId" id="meetingEventSelect">
                  <option value="">-- No Event (Independent Meeting) --</option>
                </select>
                <small style="color: var(--text-secondary); font-size: 0.875rem;">You can create a meeting without linking it to an event</small>
              </div>
              <div class="form-inline">
                <div class="form-group">
                  <label>Scheduled Time</label>
                  <input type="datetime-local" name="scheduledTime" required>
                </div>
                <div class="form-group">
                  <label>Duration (minutes)</label>
                  <input type="number" name="duration" min="15" step="15" value="60" required>
                </div>
              </div>
              <div class="form-group">
                <label>Meeting Link (Zoom, Teams, BBB, etc.)</label>
                <input type="url" name="meetingLink" placeholder="https://zoom.us/j/..." title="Enter a valid meeting URL">
                <small style="color: var(--text-secondary); font-size: 0.875rem;">Optional: Add a video conference link for this meeting</small>
              </div>
            </div>

            <div class="form-section">
              <h3>üë• Participants</h3>
              <div id="participantsList" class="list-group" style="margin-bottom: 1rem;">
                <!-- Participants will be added here -->
              </div>
              <div class="form-group">
                <label>Search Organization Members</label>
                <input type="text" id="meetingParticipantSearch" placeholder="Search by username or ID">
                <div id="meetingParticipantSearchResults" style="display: none; margin-top: 0.5rem;">
                  <!-- Search results will appear here -->
                </div>
              </div>
            </div>

            <div class="form-section">
              <h3>üìù Agenda Items</h3>
              <div id="agendaItemsList" class="list-group" style="margin-bottom: 1rem;">
                <!-- Agenda items will be added here -->
              </div>
              <button type="button" class="btn btn-secondary" id="addAgendaBtn">Add Agenda Item</button>
            </div>

            <div class="form-section">
              <h3>üìÑ Document Templates</h3>
              <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                <label style="display: flex; align-items: center; gap: 0.5rem;">
                  <input type="checkbox" name="createNotes" value="notes" checked>
                  <span>Create Meeting Notes Document</span>
                </label>
                <label style="display: flex; align-items: center; gap: 0.5rem;">
                  <input type="checkbox" name="createMinutes" value="minutes">
                  <span>Create Meeting Minutes Document</span>
                </label>
                <label style="display: flex; align-items: center; gap: 0.5rem;">
                  <input type="checkbox" name="createProtocol" value="protocol">
                  <span>Create Meeting Protocol Document</span>
                </label>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" onclick="closeMeetingModal()">Cancel</button>
          <button class="btn" onclick="submitMeetingForm()">Create Meeting</button>
        </div>
      </div>
    </div>

    <!-- Event Detail Modal -->
    <div id="eventDetailModal" class="modal modal-large">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Event Details</h2>
          <button class="close-modal" onclick="closeEventDetailModal()">√ó</button>
        </div>
        <div class="modal-body" id="eventDetailContent">
          <!-- Event details will be loaded here -->
        </div>
      </div>
    </div>

    <!-- Meeting Detail Modal -->
    <div id="meetingDetailModal" class="modal modal-large">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Meeting Details</h2>
          <button class="close-modal" onclick="closeMeetingDetailModal()">√ó</button>
        </div>
        <div class="modal-body" id="meetingDetailContent">
          <!-- Meeting details will be loaded here -->
        </div>
      </div>
    </div>

    <!-- Organization Modal -->
    <div id="organizationModal" class="modal modal-large">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Create Organization</h2>
          <button class="close-modal" onclick="closeOrganizationModal()">√ó</button>
        </div>
        <div class="modal-body">
          <form id="organizationForm">
            <div class="form-section">
              <h3>üè¢ Basic Information</h3>
              <div class="form-group">
                <label>Organization Name</label>
                <input type="text" name="name" placeholder="Enter organization name" required>
              </div>
              <div class="form-group">
                <label>Description</label>
                <textarea name="description" placeholder="Describe your organization" rows="3"></textarea>
              </div>
              <div class="form-inline">
                <div class="form-group">
                  <label>Website</label>
                  <input type="url" name="website" placeholder="https://example.com">
                </div>
                <div class="form-group">
                  <label>Logo URL</label>
                  <input type="url" name="logo" placeholder="https://example.com/logo.png">
                </div>
              </div>
            </div>

            <div class="form-section">
              <h3>‚öôÔ∏è Settings</h3>
              <div class="form-group">
                <label style="display: flex; align-items: center; gap: 0.5rem;">
                  <input type="checkbox" name="allowMemberCreateEvents" checked>
                  <span>Allow members to create events</span>
                </label>
              </div>
              <div class="form-group">
                <label style="display: flex; align-items: center; gap: 0.5rem;">
                  <input type="checkbox" name="allowMemberInviteUsers">
                  <span>Allow members to invite new users</span>
                </label>
              </div>
              <div class="form-group">
                <label style="display: flex; align-items: center; gap: 0.5rem;">
                  <input type="checkbox" name="requireEventApproval">
                  <span>Require admin approval for events</span>
                </label>
              </div>
              <div class="form-group">
                <label>Timezone</label>
                <select name="timezone">
                  <option value="UTC">UTC</option>
                  <option value="America/New_York">Eastern Time</option>
                  <option value="America/Chicago">Central Time</option>
                  <option value="America/Denver">Mountain Time</option>
                  <option value="America/Los_Angeles">Pacific Time</option>
                  <option value="Europe/London">London</option>
                  <option value="Europe/Paris">Paris</option>
                  <option value="Europe/Berlin">Berlin</option>
                  <option value="Asia/Tokyo">Tokyo</option>
                </select>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" onclick="closeOrganizationModal()">Cancel</button>
          <button class="btn" onclick="submitOrganizationForm()">Create Organization</button>
        </div>
      </div>
    </div>

    <!-- Manage Members Modal -->
    <div id="manageMembersModal" class="modal modal-large">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Manage Members</h2>
          <button class="close-modal" onclick="closeMembersModal()">√ó</button>
        </div>
        <div class="modal-body">
          <div class="form-section">
            <h3>üë• Add New Member</h3>
            <div class="form-inline">
              <div class="form-group" style="flex: 1;">
                <input type="text" id="newMemberUserId" placeholder="Enter User ID">
              </div>
              <button class="btn" onclick="addMemberToOrg()">Add Member</button>
            </div>
          </div>

          <div class="form-section">
            <h3>‚è≥ Pending Join Requests</h3>
            <div id="joinRequestsList" style="display: flex; flex-direction: column; gap: 0.75rem;">
              <!-- Join requests will be loaded here -->
            </div>
          </div>

          <div class="form-section">
            <h3>üìã Current Members</h3>
            <div id="membersList" style="display: flex; flex-direction: column; gap: 0.75rem;">
              <!-- Members will be loaded here -->
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" onclick="closeMembersModal()">Close</button>
        </div>
      </div>
    </div>

    <!-- Organization Required Modal -->
    <div id="orgRequiredModal" class="modal modal-large" style="z-index: 10000;">
      <div class="modal-content">
        <div class="modal-header" style="background: var(--warning-gradient);">
          <h2>üè¢ Organization Required</h2>
        </div>
        <div class="modal-body">
          <div style="text-align: center; padding: 2rem 0;">
            <div style="font-size: 4rem; margin-bottom: 1rem;">üè¢</div>
            <h3 style="margin-bottom: 1rem;">Welcome to Planify!</h3>
            <p style="color: var(--text-secondary); margin-bottom: 2rem;">
              To start planning events and meetings, you need to create or join an organization.
            </p>
          </div>

          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 2rem;">
            <div style="padding: 2rem; background: var(--gray-50); border-radius: var(--radius-lg); text-align: center; cursor: pointer; transition: all var(--transition-base);" onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='var(--shadow-xl)'" onmouseout="this.style.transform=''; this.style.boxShadow=''" onclick="showCreateOrgFromRequired()">
              <div style="font-size: 3rem; margin-bottom: 1rem;">‚ûï</div>
              <h4 style="margin-bottom: 0.5rem;">Create Organization</h4>
              <p style="color: var(--text-secondary); font-size: 0.875rem;">Start your own organization and invite team members</p>
            </div>

            <div style="padding: 2rem; background: var(--gray-50); border-radius: var(--radius-lg); text-align: center; cursor: pointer; transition: all var(--transition-base);" onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='var(--shadow-xl)'" onmouseout="this.style.transform=''; this.style.boxShadow=''" onclick="showJoinOrgForm()">
              <div style="font-size: 3rem; margin-bottom: 1rem;">üîó</div>
              <h4 style="margin-bottom: 0.5rem;">Join Organization</h4>
              <p style="color: var(--text-secondary); font-size: 0.875rem;">Request to join an existing organization</p>
            </div>
          </div>

          <div id="joinOrgForm" style="display: none;">
            <div class="form-section">
              <h3>üîç Find Organization</h3>
              <div class="form-group">
                <label>Organization Name or ID</label>
                <input type="text" id="joinOrgSearch" placeholder="Type to search organizations...">
              </div>
              
              <div id="orgSearchResults" style="display: none; margin-top: 1rem;">
                <h4 style="margin-bottom: 1rem;">Available Organizations</h4>
                <div id="orgResultsList" style="display: flex; flex-direction: column; gap: 0.75rem;">
                  <!-- Search results will appear here -->
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer"></div>

  </div>

  <script src="js/app.js"></script>
</body>
</html>
